---
title: React 中的虚拟 DOM 是什么？
---

## TL;DR

React 中的虚拟 DOM 是实际 DOM 的轻量级副本。它允许 React 通过比较虚拟 DOM 和真实 DOM 并仅进行必要的更改来有效地更新 UI。此过程称为协调。通过使用虚拟 DOM，React 最小化了对真实 DOM 的直接操作，这可能很慢且效率低下。

***

## React 中的虚拟 DOM 是什么？

### 简介

虚拟 DOM 是 React 等库实现的一个概念，用于提高 Web 应用程序的性能。它是一个编程概念，其中 UI 的虚拟表示保存在内存中，并通过 ReactDOM 等库与真实 DOM 同步。

### 工作原理

1. **初始渲染**：首次渲染 React 组件时，会创建一个虚拟 DOM 树。此树是实际 DOM 的轻量级副本。
2. **更新状态**：当组件的状态发生变化时，会创建一个新的虚拟 DOM 树。然后，React 将此新树与前一个树进行比较。
3. **差异算法**：React 使用差异算法来查找新虚拟 DOM 树与前一个树之间的差异。此过程称为协调。
4. **更新真实 DOM**：在确定差异后，React 仅更新已更改的真实 DOM 部分，而不是重新渲染整个 UI。

### 优点

* **性能**：通过最大限度地减少对真实 DOM 的直接操作，React 可以更有效地更新 UI。
* **抽象**：开发人员可以编写代码，而无需担心直接 DOM 操作的性能影响。
* **可预测性**：虚拟 DOM 提供了一种可预测的方式来更新 UI，从而更容易推断应用程序的状态。

### 示例

这是一个简单的例子，说明虚拟 DOM 在 React 中的工作方式：

```jsx
import React, { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>You clicked {count} times</p>
      <button onClick={() => setCount(count + 1)}>Click me</button>
    </div>
  );
}

export default Counter;
```

在此示例中，当单击按钮时，状态 `count` 会更新。React 创建一个新的虚拟 DOM 树，将其与前一个树进行比较，并仅更新真实 DOM 中 `<p>` 标签内的文本。

## 延伸阅读

* [React documentation on reconciliation](https://react.dev/learn/preserving-and-resetting-state)
* [Understanding the virtual DOM](https://medium.com/@deathmood/how-to-write-your-own-virtual-dom-ee74acc13060)
